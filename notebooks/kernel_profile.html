<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
.r1 {color: #005f00; text-decoration-color: #005f00}
.r2 {font-weight: bold}
.r3 {color: #000080; text-decoration-color: #000080; font-weight: bold}
.r4 {color: #005f00; text-decoration-color: #005f00; font-weight: bold}
.r5 {color: #87af00; text-decoration-color: #87af00; font-weight: bold}
.r6 {color: #7f7f7f; text-decoration-color: #7f7f7f; font-weight: bold}
.r7 {color: #000080; text-decoration-color: #000080; font-weight: bold; font-style: italic}
.r8 {color: #005f00; text-decoration-color: #005f00; font-weight: bold; font-style: italic}
.r9 {color: #87af00; text-decoration-color: #87af00; font-weight: bold; font-style: italic}
.r10 {color: #7f7f7f; text-decoration-color: #7f7f7f}
.r11 {color: #000080; text-decoration-color: #000080}
.r12 {color: #87af00; text-decoration-color: #87af00}
.r13 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8; font-weight: bold}
.r14 {color: #000000; text-decoration-color: #000000; background-color: #f8f8f8}
.r15 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8; font-weight: bold}
.r16 {background-color: #f8f8f8}
.r17 {color: #666666; text-decoration-color: #666666; background-color: #f8f8f8}
.r18 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8}
.r19 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8}
.r20 {color: #bbbbbb; text-decoration-color: #bbbbbb; background-color: #f8f8f8}
.r21 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8; font-style: italic}
.r22 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8}
.r23 {color: #aa22ff; text-decoration-color: #aa22ff; background-color: #f8f8f8; font-weight: bold}
.r24 {color: #3d7b7b; text-decoration-color: #3d7b7b; background-color: #f8f8f8; font-style: italic}
.r25 {font-weight: bold; font-style: italic}
.r26 {color: #800000; text-decoration-color: #800000; font-weight: bold}
.r27 {color: #000080; text-decoration-color: #000080; text-decoration: underline}
body {
    color: #000000;
    background-color: #ffffff;
}
</style>
</head>
<body>
    <pre style="font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><code>                           Memory usage: <span class="r1">▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█</span> (max: 24.566 GB, growth rate: 100%)                           
  /Users/daniellebarnes/development/teaspoon/notebooks/profiling.py: % of time = 100.00% (2h:25m:58.713s) out of 2h:25m:58.713s.   
       ╷       ╷       ╷       ╷        ╷       ╷               ╷       ╷                                                          
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r4">Memory</span><span class="r2">  </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r4">–––––––––––</span><span class="r2">    </span>│<span class="r5">Copy</span><span class="r2">   </span>│<span class="r2">                                                         </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">system</span><span class="r2"> </span>│<span class="r8">Python</span><span class="r2">  </span>│<span class="r8">peak</span><span class="r2">   </span>│<span class="r8">timeline</span><span class="r4">/%</span><span class="r2">     </span>│<span class="r9">(MB/s)</span><span class="r2"> </span>│<span class="r2">/Users/daniellebarnes/development/teaspoon/notebooks/pr… </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">    1 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1"> 100%   </span>│<span class="r1">   30M </span>│<span class="r1">▁▁▁            </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">teaspoon.ML</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> load_datasets</span><span class="r16">                   </span>  
 <span class="r10">    2 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">import</span><span class="r14"> </span><span class="r15">time</span><span class="r16">                                             </span>  
 <span class="r10">    3 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">import</span><span class="r14"> </span><span class="r15">numpy</span><span class="r14"> </span><span class="r13">as</span><span class="r14"> </span><span class="r15">np</span><span class="r16">                                      </span>  
 <span class="r10">    4 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1"> 100%   </span>│<span class="r1">   20M </span>│<span class="r1">▁▁             </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">sklearn.model_selection</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> train_test_split</span><span class="r16">    </span>  
 <span class="r10">    5 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">import</span><span class="r14"> </span><span class="r15">math</span><span class="r16">                                             </span>  
 <span class="r10">    6 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">numpy.linalg</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> norm </span><span class="r13">as</span><span class="r14"> lnorm</span><span class="r16">                  </span>  
 <span class="r10">    7 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">math</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> pi</span><span class="r16">                                     </span>  
 <span class="r10">    8 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">sklearn.metrics</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> DistanceMetric</span><span class="r16">              </span>  
 <span class="r10">    9 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">numpy.linalg</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> norm </span><span class="r13">as</span><span class="r14"> lnorm</span><span class="r16">                  </span>  
 <span class="r10">   10 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">import</span><span class="r14"> </span><span class="r15">numpy</span><span class="r14"> </span><span class="r13">as</span><span class="r14"> </span><span class="r15">np</span><span class="r16">                                      </span>  
 <span class="r10">   11 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1"> 100%   </span>│<span class="r1">   20M </span>│<span class="r1">▁▁             </span>│<span class="r12">       </span>│<span class="r13">from</span><span class="r14"> </span><span class="r15">persim</span><span class="r14"> </span><span class="r13">import</span><span class="r14"> heat</span><span class="r16">                                 </span>  
 <span class="r10">   12 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   13 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">  96%   </span>│<span class="r1">  360M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁   1% </span>│<span class="r12">       </span>│<span class="r14">mnist </span><span class="r17">=</span><span class="r14"> load_datasets</span><span class="r17">.</span><span class="r14">mnist()</span><span class="r16">                           </span>  
 <span class="r10">   14 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   15 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">train_test_split_sklearn</span><span class="r14">(DgmsFD, labels_col, train_s</span>  
 <span class="r10">   16 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14"> </span><span class="r16">                                                       </span>  
 <span class="r10">   17 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    labels </span><span class="r17">=</span><span class="r14"> DgmsFD[labels_col]</span><span class="r16">                         </span>  
 <span class="r10">   18 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    training_dgms, testing_dgms </span><span class="r17">=</span><span class="r14"> train_test_split(DgmsF</span>  
 <span class="r10">   19 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> training_dgms</span><span class="r17">.</span><span class="r14">reset_index(), testing_dgms</span><span class="r17">.</span><span class="r14">res</span>  
 <span class="r10">   20 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   21 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">dgms_train, dgms_test </span><span class="r17">=</span><span class="r14"> train_test_split_sklearn(mnist, </span>  
 <span class="r10">   22 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">xdgm0_train </span><span class="r17">=</span><span class="r14"> dgms_train[</span><span class="r19">&#x27;zero_dim_rtl&#x27;</span><span class="r14">]</span><span class="r16">                </span>  
 <span class="r10">   23 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">xdgm0_test </span><span class="r17">=</span><span class="r14"> dgms_test[</span><span class="r19">&#x27;zero_dim_rtl&#x27;</span><span class="r14">]</span><span class="r16">                  </span>  
 <span class="r10">   24 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">xdgm1_train </span><span class="r17">=</span><span class="r14"> dgms_train[</span><span class="r19">&#x27;one_dim_rtl&#x27;</span><span class="r14">]</span><span class="r16">                 </span>  
 <span class="r10">   25 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">xdgm1_test </span><span class="r17">=</span><span class="r14"> dgms_test[</span><span class="r19">&#x27;one_dim_rtl&#x27;</span><span class="r14">]</span><span class="r16">                   </span>  
 <span class="r10">   26 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">labels_train </span><span class="r17">=</span><span class="r14"> dgms_train[</span><span class="r19">&#x27;labels&#x27;</span><span class="r14">]</span><span class="r16">                     </span>  
 <span class="r10">   27 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">labels_test </span><span class="r17">=</span><span class="r14"> dgms_test[</span><span class="r19">&#x27;labels&#x27;</span><span class="r14">]</span><span class="r16">                       </span>  
 <span class="r10">   28 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   29 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">KernelMethod</span><span class="r14">(perDgm1, perDgm2, sigma):</span><span class="r16">              </span>  
 <span class="r10">   30 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r20">    </span><span class="r21">&quot;&quot;&quot;</span><span class="r16">                                                 </span>  
 <span class="r10">   31 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   32 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    This function computes the kernel for given two pers</span>  
 <span class="r10">   33 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    There are three inputs and these are two persistence</span>  
 <span class="r10">   34 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   35 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    Parameters</span><span class="r16">                                          </span>  
 <span class="r10">   36 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    ----------</span><span class="r16">                                          </span>  
 <span class="r10">   37 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    perDgm1 : ndarray</span><span class="r16">                                   </span>  
 <span class="r10">   38 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">        Object array that includes first persistence dia</span>  
 <span class="r10">   39 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    perDgm2 : ndarray</span><span class="r16">                                   </span>  
 <span class="r10">   40 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">        Object array that includes second persistence di</span>  
 <span class="r10">   41 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    sigma : float</span><span class="r16">                                       </span>  
 <span class="r10">   42 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">        Kernel scale.</span><span class="r16">                                   </span>  
 <span class="r10">   43 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   44 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    Returns</span><span class="r16">                                             </span>  
 <span class="r10">   45 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    -------</span><span class="r16">                                             </span>  
 <span class="r10">   46 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    Kernel : float</span><span class="r16">                                      </span>  
 <span class="r10">   47 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">        The kernel value for given two persistence diagr</span>  
 <span class="r10">   48 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   49 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r21">    &quot;&quot;&quot;</span><span class="r16">                                                 </span>  
 <span class="r10">   50 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r16">                                                    </span>  
 <span class="r10">   51 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    L1 </span><span class="r17">=</span><span class="r14"> </span><span class="r22">len</span><span class="r14">(perDgm1)</span><span class="r16">                                   </span>  
 <span class="r10">   52 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    L2 </span><span class="r17">=</span><span class="r14"> </span><span class="r22">len</span><span class="r14">(perDgm2)</span><span class="r16">                                   </span>  
 <span class="r10">   53 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    kernel </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">zeros((L2, L1))</span><span class="r16">                         </span>  
 <span class="r10">   54 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   55 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    Kernel </span><span class="r17">=</span><span class="r14"> </span><span class="r17">0</span><span class="r16">                                          </span>  
 <span class="r10">   56 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   57 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">for</span><span class="r14"> i </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">, L1):</span><span class="r16">                              </span>  
 <span class="r10">   58 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">        p </span><span class="r17">=</span><span class="r14"> perDgm1[i]</span><span class="r16">                                  </span>  
 <span class="r10">   59 </span>│<span class="r11">    4% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">        p </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">reshape(p, (</span><span class="r17">2</span><span class="r14">, </span><span class="r17">1</span><span class="r14">))</span><span class="r16">                       </span>  
 <span class="r10">   60 </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">        </span><span class="r13">for</span><span class="r14"> j </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">, L2):</span><span class="r16">                          </span>  
 <span class="r10">   61 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            q </span><span class="r17">=</span><span class="r14"> perDgm2[j]</span><span class="r16">                              </span>  
 <span class="r10">   62 </span>│<span class="r11">    7% </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">     1 </span>│<span class="r14">            q </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">reshape(q, (</span><span class="r17">2</span><span class="r14">, </span><span class="r17">1</span><span class="r14">))</span><span class="r16">                   </span>  
 <span class="r10">   63 </span>│<span class="r11">    2% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">     1 </span>│<span class="r14">            q_bar </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">zeros((</span><span class="r17">2</span><span class="r14">, </span><span class="r17">1</span><span class="r14">))</span><span class="r16">                    </span>  
 <span class="r10">   64 </span>│<span class="r11">    4% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">     1 </span>│<span class="r14">            q_bar[</span><span class="r17">0</span><span class="r14">] </span><span class="r17">=</span><span class="r14"> q[</span><span class="r17">1</span><span class="r14">]</span><span class="r16">                             </span>  
 <span class="r10">   65 </span>│<span class="r11">    3% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">     1 </span>│<span class="r14">            q_bar[</span><span class="r17">1</span><span class="r14">] </span><span class="r17">=</span><span class="r14"> q[</span><span class="r17">0</span><span class="r14">]</span><span class="r16">                             </span>  
 <span class="r10">   66 </span>│<span class="r11">   20% </span>│<span class="r11">    3% </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">     5 </span>│<span class="r14">            dist1 </span><span class="r17">=</span><span class="r14"> lnorm(p</span><span class="r17">-</span><span class="r14">q)</span><span class="r16">                          </span>  
 <span class="r10">   67 </span>│<span class="r11">   19% </span>│<span class="r11">    3% </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">     5 </span>│<span class="r14">            dist2 </span><span class="r17">=</span><span class="r14"> lnorm(p</span><span class="r17">-</span><span class="r14">q_bar)</span><span class="r16">                      </span>  
 <span class="r10">   68 </span>│<span class="r11">    9% </span>│<span class="r11">    2% </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            kernel[j, i] </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">exp(</span><span class="r17">-</span><span class="r14">(math</span><span class="r17">.</span><span class="r14">pow(dist1, </span><span class="r17">2</span><span class="r14">))</span><span class="r17">/</span>  
 <span class="r10">   69 </span>│<span class="r11">    6% </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">                np</span><span class="r17">.</span><span class="r14">exp(</span><span class="r17">-</span><span class="r14">(math</span><span class="r17">.</span><span class="r14">pow(dist2, </span><span class="r17">2</span><span class="r14">))</span><span class="r17">/</span><span class="r14">(</span><span class="r17">8*</span><span class="r14">sigma))</span><span class="r16"> </span>  
 <span class="r10">   70 </span>│<span class="r11">    2% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            Kernel </span><span class="r17">=</span><span class="r14"> Kernel</span><span class="r17">+</span><span class="r14">kernel[j, i]</span><span class="r16">                </span>  
 <span class="r10">   71 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    Kernel </span><span class="r17">=</span><span class="r14"> Kernel</span><span class="r17">*</span><span class="r14">(</span><span class="r17">1/</span><span class="r14">(</span><span class="r17">8*</span><span class="r14">pi</span><span class="r17">*</span><span class="r14">sigma))</span><span class="r16">                    </span>  
 <span class="r10">   72 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   73 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> Kernel</span><span class="r16">                                       </span>  
 <span class="r10">   74 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   75 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">heat_kernel_distance</span><span class="r14">(dgm0, dgm1, sigma</span><span class="r17">=.4</span><span class="r14">):</span><span class="r16">         </span>  
 <span class="r10">   76 </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">sqrt(KernelMethod(dgm0, dgm0, sigma) </span><span class="r17">+</span><span class="r14"> Ker</span>  
 <span class="r10">   77 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   78 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">kernel_features</span><span class="r14">(train, s):</span><span class="r16">                          </span>  
 <span class="r10">   79 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    n_train </span><span class="r17">=</span><span class="r14"> </span><span class="r22">len</span><span class="r14">(train)</span><span class="r16">                                </span>  
 <span class="r10">   80 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">24.21G </span>│<span class="r1">█  98%         </span>│<span class="r12">       </span>│<span class="r14">    X_train_features </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">zeros((n_train, n_train))</span><span class="r16">     </span>  
 <span class="r10">   81 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r16">                                                    </span>  
 <span class="r10">   82 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    start </span><span class="r17">=</span><span class="r14"> time</span><span class="r17">.</span><span class="r14">time()</span><span class="r16">                                 </span>  
 <span class="r10">   83 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">for</span><span class="r14"> i </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">,n_train):</span><span class="r16">                          </span>  
 <span class="r10">   84 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">        </span><span class="r13">for</span><span class="r14"> j </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">,i):</span><span class="r16">                            </span>  
 <span class="r10">   85 </span>│<span class="r11">    2% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            dgm0 </span><span class="r17">=</span><span class="r14"> train[i]</span><span class="r16">                             </span>  
 <span class="r10">   86 </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            dgm1 </span><span class="r17">=</span><span class="r14"> train[j]</span><span class="r16">                             </span>  
 <span class="r10">   87 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            hka </span><span class="r17">=</span><span class="r14"> heat_kernel_distance(dgm0, dgm1, sigma</span>  
 <span class="r10">   88 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            X_train_features[i,j] </span><span class="r17">=</span><span class="r14"> hka</span><span class="r16">                 </span>  
 <span class="r10">   89 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            X_train_features[j,i] </span><span class="r17">=</span><span class="r14"> hka</span><span class="r16">                 </span>  
 <span class="r10">   90 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   91 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    timing </span><span class="r17">=</span><span class="r14"> time</span><span class="r17">.</span><span class="r14">time()</span><span class="r17">-</span><span class="r14">start</span><span class="r16">                          </span>  
 <span class="r10">   92 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> timing, X_train_features</span><span class="r16">                     </span>  
 <span class="r10">   93 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">   94 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">fast_hk</span><span class="r14">(dgm0,dgm1,sigma</span><span class="r17">=.4</span><span class="r14">):</span><span class="r16">                        </span>  
 <span class="r10">   95 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r16">                                                    </span>  
 <span class="r10">   96 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    dist </span><span class="r17">=</span><span class="r14"> DistanceMetric</span><span class="r17">.</span><span class="r14">get_metric(</span><span class="r19">&#x27;euclidean&#x27;</span><span class="r14">)</span><span class="r16">       </span>  
 <span class="r10">   97 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    dist1 </span><span class="r17">=</span><span class="r14"> (dist</span><span class="r17">.</span><span class="r14">pairwise(dgm0,dgm1))</span><span class="r17">**2</span><span class="r16">               </span>  
 <span class="r10">   98 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    Qc </span><span class="r17">=</span><span class="r14"> dgm1[:,</span><span class="r17">1</span><span class="r14">::</span><span class="r17">-1</span><span class="r14">]</span><span class="r16">                                  </span>  
 <span class="r10">   99 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    dist2 </span><span class="r17">=</span><span class="r14"> (dist</span><span class="r17">.</span><span class="r14">pairwise(dgm0,Qc))</span><span class="r17">**2</span><span class="r16">                 </span>  
 <span class="r10">  100 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    exp_dist1 </span><span class="r17">=</span><span class="r14"> </span><span class="r22">sum</span><span class="r14">(</span><span class="r22">sum</span><span class="r14">(np</span><span class="r17">.</span><span class="r14">exp(</span><span class="r17">-</span><span class="r14">dist1</span><span class="r17">/</span><span class="r14">(</span><span class="r17">8*</span><span class="r14">sigma))))</span><span class="r16">      </span>  
 <span class="r10">  101 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    exp_dist2 </span><span class="r17">=</span><span class="r14"> </span><span class="r22">sum</span><span class="r14">(</span><span class="r22">sum</span><span class="r14">(np</span><span class="r17">.</span><span class="r14">exp(</span><span class="r17">-</span><span class="r14">dist2</span><span class="r17">/</span><span class="r14">(</span><span class="r17">8*</span><span class="r14">sigma))))</span><span class="r16">      </span>  
 <span class="r10">  102 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    hk </span><span class="r17">=</span><span class="r14"> (exp_dist1</span><span class="r17">-</span><span class="r14">exp_dist2)</span><span class="r17">/</span><span class="r14">(</span><span class="r17">8*</span><span class="r14">np</span><span class="r17">.</span><span class="r14">pi</span><span class="r17">*</span><span class="r14">sigma)</span><span class="r16">          </span>  
 <span class="r10">  103 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14">(hk)</span><span class="r16">                                          </span>  
 <span class="r10">  104 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  105 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">heat_kernel_approx</span><span class="r14">(dgm0, dgm1, sigma</span><span class="r17">=.4</span><span class="r14">):</span><span class="r16">           </span>  
 <span class="r10">  106 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">sqrt(fast_hk(dgm0, dgm0, sigma) </span><span class="r17">+</span><span class="r14"> fast_hk(</span>  
 <span class="r10">  107 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  108 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">fast_kernel_features</span><span class="r14">(train, s):</span><span class="r16">                     </span>  
 <span class="r10">  109 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    n_train </span><span class="r17">=</span><span class="r14"> </span><span class="r22">len</span><span class="r14">(train)</span><span class="r16">                                </span>  
 <span class="r10">  110 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    X_train_features </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">zeros((n_train, n_train))</span><span class="r16">     </span>  
 <span class="r10">  111 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r16">                                                    </span>  
 <span class="r10">  112 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    start </span><span class="r17">=</span><span class="r14"> time</span><span class="r17">.</span><span class="r14">time()</span><span class="r16">                                 </span>  
 <span class="r10">  113 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">for</span><span class="r14"> i </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">,n_train):</span><span class="r16">                          </span>  
 <span class="r10">  114 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">        </span><span class="r13">for</span><span class="r14"> j </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">,i):</span><span class="r16">                            </span>  
 <span class="r10">  115 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            dgm0 </span><span class="r17">=</span><span class="r14"> train[i]</span><span class="r16">                             </span>  
 <span class="r10">  116 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            dgm1 </span><span class="r17">=</span><span class="r14"> train[j]</span><span class="r16">                             </span>  
 <span class="r10">  117 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            hka </span><span class="r17">=</span><span class="r14"> heat_kernel_approx(dgm0, dgm1, sigma </span><span class="r17">=</span>  
 <span class="r10">  118 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            X_train_features[i,j] </span><span class="r17">=</span><span class="r14"> hka</span><span class="r16">                 </span>  
 <span class="r10">  119 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            X_train_features[j,i] </span><span class="r17">=</span><span class="r14"> hka</span><span class="r16">                 </span>  
 <span class="r10">  120 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  121 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    timing </span><span class="r17">=</span><span class="r14"> time</span><span class="r17">.</span><span class="r14">time()</span><span class="r17">-</span><span class="r14">start</span><span class="r16">                          </span>  
 <span class="r10">  122 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> timing, X_train_features</span><span class="r16">                     </span>  
 <span class="r10">  123 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  124 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r13">def</span><span class="r14"> </span><span class="r18">persim_kernel_features</span><span class="r14">(train, s):</span><span class="r16">                   </span>  
 <span class="r10">  125 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    n_train </span><span class="r17">=</span><span class="r14"> </span><span class="r22">len</span><span class="r14">(train)</span><span class="r16">                                </span>  
 <span class="r10">  126 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    X_train_features </span><span class="r17">=</span><span class="r14"> np</span><span class="r17">.</span><span class="r14">zeros((n_train, n_train))</span><span class="r16">     </span>  
 <span class="r10">  127 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r16">                                                    </span>  
 <span class="r10">  128 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    start </span><span class="r17">=</span><span class="r14"> time</span><span class="r17">.</span><span class="r14">time()</span><span class="r16">                                 </span>  
 <span class="r10">  129 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">for</span><span class="r14"> i </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">,n_train):</span><span class="r16">                          </span>  
 <span class="r10">  130 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">        </span><span class="r13">for</span><span class="r14"> j </span><span class="r23">in</span><span class="r14"> </span><span class="r22">range</span><span class="r14">(</span><span class="r17">0</span><span class="r14">,i):</span><span class="r16">                            </span>  
 <span class="r10">  131 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            dgm0 </span><span class="r17">=</span><span class="r14"> train[i]</span><span class="r16">                             </span>  
 <span class="r10">  132 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            dgm1 </span><span class="r17">=</span><span class="r14"> train[j]</span><span class="r16">                             </span>  
 <span class="r10">  133 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            hka </span><span class="r17">=</span><span class="r14"> heat(dgm0, dgm1, sigma </span><span class="r17">=</span><span class="r14"> s) </span><span class="r16">          </span>  
 <span class="r10">  134 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            X_train_features[i,j] </span><span class="r17">=</span><span class="r14"> hka</span><span class="r16">                 </span>  
 <span class="r10">  135 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">            X_train_features[j,i] </span><span class="r17">=</span><span class="r14"> hka</span><span class="r16">                 </span>  
 <span class="r10">  136 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  137 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    timing </span><span class="r17">=</span><span class="r14"> time</span><span class="r17">.</span><span class="r14">time()</span><span class="r17">-</span><span class="r14">start</span><span class="r16">                          </span>  
 <span class="r10">  138 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    </span><span class="r13">return</span><span class="r14"> timing, X_train_features</span><span class="r16">                     </span>  
 <span class="r10">  139 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  140 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r24">#train_test = xdgm0_train[0:50000]</span><span class="r16">                      </span>  
 <span class="r10">  141 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r16">                                                        </span>  
 <span class="r10">  142 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">kernel_features(xdgm0_train, s </span><span class="r17">=</span><span class="r14"> </span><span class="r17">.3</span><span class="r14">)</span><span class="r16">                    </span>  
 <span class="r10">      </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                          
╶──────┼───────┼───────┼───────┼────────┼───────┼───────────────┼───────┼─────────────────────────────────────────────────────────╴
 <span class="r10">      </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r25">function summary for /Users/daniellebarnes/development/…</span>  
 <span class="r10">   15 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">Scalene</span><span class="r17">.</span><span class="r14">train_test_split_sklearn</span><span class="r16">                        </span>  
 <span class="r10">   29 </span>│<span class="r26">   79%</span><span class="r11"> </span>│<span class="r26">   14%</span><span class="r11"> </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">    13 </span>│<span class="r14">Scalene</span><span class="r17">.</span><span class="r14">KernelMethod</span><span class="r16">                                    </span>  
 <span class="r10">   75 </span>│<span class="r11">    2% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">Scalene</span><span class="r17">.</span><span class="r14">heat_kernel_distance</span><span class="r16">                            </span>  
 <span class="r10">   78 </span>│<span class="r11">    3% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r1">        </span>│<span class="r1">24.21G </span>│<span class="r1">█  98%         </span>│<span class="r12">       </span>│<span class="r14">Scalene</span><span class="r17">.</span><span class="r14">kernel_features</span><span class="r16">                                 </span>  
       ╵       ╵       ╵       ╵        ╵       ╵               ╵       ╵                                                          
Top AVERAGE memory consumption, by line:
<span class="r1">(1)    80: 24793 MB</span>                                                                                                                 
Top PEAK memory consumption, by line:
<span class="r1">(1)    80: 24793 MB</span>                                                                                                                 
<span class="r1">(2)    13:   360 MB</span>                                                                                                                 
<span class="r1">(3)     1:    30 MB</span>                                                                                                                 
<span class="r1">(4)     4:    20 MB</span>                                                                                                                 
<span class="r1">(5)    11:    20 MB</span>                                                                                                                 
generated by the <a class="r27" href="https://github.com/plasma-umass/scalene">scalene</a> profiler                                                                                                   
</code></pre>
</body>
</html>
