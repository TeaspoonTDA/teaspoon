<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.2.2.2. Persistence Images &mdash; teaspoon 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.2.2.3. Carlsson Coordinates" href="CL_CC.html" />
    <link rel="prev" title="2.2.2.1. Persistence Landscapes" href="CL_PL.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> teaspoon<img src="_static/teaspoon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#requirements">1.1. Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation">1.2. Installation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">2. Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="parameter_selection.html">2.1. Parameter Selection Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MI.html">2.1.1. Mutual Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="AC.html">2.1.2. Auto-correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="FSA.html">2.1.3. Fourier Spectrum Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="PAMI.html">2.1.4. Permutation Auto Mutual Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="MsPE.html">2.1.5. Multi-scale Permutation Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="FNN.html">2.1.6. False Nearest Neighbors</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="ML.html">2.2. Machine Learning (ML) Module</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="F_PD.html">2.2.1. Featurization</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="CL.html">2.2.2. Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML.html#references">2.2.3. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TDA.html">2.3. Topological Data Analaysis (TDA) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PHN.html">2.3.1. Persistent Homology of Networks (PHN) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="distances.html">2.3.2. Distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="drawing.html">2.3.3. Drawing</a></li>
<li class="toctree-l3"><a class="reference internal" href="persistence.html">2.3.4. Persistence</a></li>
<li class="toctree-l3"><a class="reference internal" href="sublevel_set_persistence.html">2.3.5. Zero Dimensional Sublevel Set Persistence (SLSP) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="buzz.html">2.3.6. Bifurcations using ZigZag (BuZZ)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ZZ_TG.html">2.3.7. Temporal Network Analysis Using Zigzag Persistence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SP.html">2.4. Signal Processing (SP) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tsa.html">2.4.1. Time Series Analysis (TSA) Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="network.html">2.4.2. Network Representation of Time Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="information.html">2.4.3. Information Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="misc.html">2.4.4. Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MakeData.html">2.5. Make Data (MakeData) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PointCloud.html">2.5.1. Point Cloud Data Generation (PointCloud) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="DynSysLib.html">2.5.2. Dynamic Systems Library (DynSysLib) Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">3. Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#contributing-to-documentation">3.1. Contributing to Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">4. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">5. Citing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">teaspoon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html"><span class="section-number">2. </span>Table of Contents</a> &raquo;</li>
          <li><a href="ML.html"><span class="section-number">2.2. </span>Persistence Diagram Featurization</a> &raquo;</li>
          <li><a href="CL.html"><span class="section-number">2.2.2. </span>Classification</a> &raquo;</li>
      <li><span class="section-number">2.2.2.2. </span>Persistence Images</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/CL_PI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="persistence-images">
<h1><span class="section-number">2.2.2.2. </span>Persistence Images<a class="headerlink" href="#persistence-images" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>In this section, we provide examples for classification using persistence images.
As mentioned in <a class="reference internal" href="F_PD.html#persistence-images"><span class="std std-ref">Persistence Images</span></a> section, we use <a class="reference external" href="https://persim.scikit-tda.org/en/latest/notebooks/Classification%20with%20persistence%20images.html">Persim</a> library
to compute persistence images.
This library can automatically capture the bounds of the image. Our algorithm implements that option, so user
do not need to give boundaries for life time and birth time of the images.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML.PD_Classification</span> <span class="kn">import</span> <span class="n">getPercentScore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML</span> <span class="kn">import</span> <span class="n">feature_functions</span> <span class="k">as</span> <span class="n">fF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML.Base</span> <span class="kn">import</span> <span class="n">ParameterBucket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.MakeData.PointCloud</span> <span class="kn">import</span> <span class="n">testSetManifolds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># generate persistence diagrams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF</span> <span class="o">=</span> <span class="n">testSetManifolds</span><span class="p">(</span><span class="n">numDgms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">numPts</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_col</span><span class="o">=</span><span class="s1">&#39;trainingLabel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dgm_col</span><span class="o">=</span><span class="s1">&#39;Dgm1&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># convert categorical labels into integers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">DgmsDF</span><span class="p">[</span><span class="n">labels_col</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF</span><span class="p">[</span><span class="n">labels_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set classification parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">ParameterBucket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">feature_function</span> <span class="o">=</span> <span class="n">fF</span><span class="o">.</span><span class="n">F_Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">k_fold_cv</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">clf_model</span> <span class="o">=</span> <span class="n">SVC</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># perform classification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_report_train</span><span class="p">,</span><span class="n">c_report_test</span><span class="o">=</span><span class="n">getPercentScore</span><span class="p">(</span><span class="n">DgmsDF</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">labels_col</span><span class="o">=</span><span class="s1">&#39;trainingLabel&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">dgm_col</span><span class="o">=</span><span class="s1">&#39;Dgm1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">precomputed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">saving</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">saving_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">Beginning experiments</span>

<span class="go">Run Number: 1</span>
<span class="go">Test set acc.: 0.583</span>
<span class="go">Training set acc.: 0.688</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 2</span>
<span class="go">Test set acc.: 0.750</span>
<span class="go">Training set acc.: 0.823</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 3</span>
<span class="go">Test set acc.: 0.708</span>
<span class="go">Training set acc.: 0.771</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 4</span>
<span class="go">Test set acc.: 0.583</span>
<span class="go">Training set acc.: 0.688</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 5</span>
<span class="go">Test set acc.: 0.625</span>
<span class="go">Training set acc.: 0.708</span>
<span class="go">------------------------------</span>

<span class="go">Finished with training/testing experiments</span>

<span class="go">Test Set</span>
<span class="go">---------</span>
<span class="go">Average accuracy: 0.650</span>
<span class="go">Standard deviation: 0.068</span>

<span class="go">Training Set</span>
<span class="go">---------</span>
<span class="go">Average accuracy: 0.735</span>
<span class="go">Standard deviation: 0.053</span>

<span class="go">For more metrics, see the outputs.</span>
</pre></div>
</div>
<div class="section" id="transfer-learning-between-two-sets-of-persistence-diagrams">
<h2><span class="section-number">2.2.2.2.1. </span>Transfer learning between two sets of persistence diagrams<a class="headerlink" href="#transfer-learning-between-two-sets-of-persistence-diagrams" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>User can enable transfer learning option to train and test a classifier using two different sets of
persistence diagrams. The first diagram is treated as the training set, while the second diagram is considered
as test set.
For given two sets of diagrams, algorithm computes their images and generates feature matrices.
Then, supervised classification is performed with respect defined parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML.PD_Classification</span> <span class="kn">import</span> <span class="n">getPercentScore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML</span> <span class="kn">import</span> <span class="n">feature_functions</span> <span class="k">as</span> <span class="n">fF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML.Base</span> <span class="kn">import</span> <span class="n">ParameterBucket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.MakeData.PointCloud</span> <span class="kn">import</span> <span class="n">testSetManifolds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># generate persistence diagrams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF_train</span> <span class="o">=</span> <span class="n">testSetManifolds</span><span class="p">(</span><span class="n">numDgms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">numPts</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF_test</span> <span class="o">=</span> <span class="n">testSetManifolds</span><span class="p">(</span><span class="n">numDgms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">numPts</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_col</span><span class="o">=</span><span class="s1">&#39;trainingLabel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dgm_col</span><span class="o">=</span><span class="s1">&#39;Dgm1&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># convert categorical labels into integers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_train</span><span class="p">,</span><span class="n">x_test</span> <span class="o">=</span> <span class="n">DgmsDF_train</span><span class="p">[</span><span class="n">labels_col</span><span class="p">],</span><span class="n">DgmsDF_test</span><span class="p">[</span><span class="n">labels_col</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_test</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF_train</span><span class="p">[</span><span class="n">labels_col</span><span class="p">],</span><span class="n">DgmsDF_test</span><span class="p">[</span><span class="n">labels_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set classification parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">ParameterBucket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">feature_function</span> <span class="o">=</span> <span class="n">fF</span><span class="o">.</span><span class="n">F_Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">k_fold_cv</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">clf_model</span> <span class="o">=</span> <span class="n">SVC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">TF_Learning</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_report_train</span><span class="p">,</span><span class="n">c_report_test</span><span class="o">=</span><span class="n">getPercentScore</span><span class="p">(</span><span class="n">DgmsDF_train</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">labels_col</span><span class="o">=</span><span class="s1">&#39;trainingLabel&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">dgm_col</span><span class="o">=</span><span class="s1">&#39;Dgm1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">precomputed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">saving</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">saving_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">DgmsDF_test</span> <span class="o">=</span> <span class="n">DgmsDF_test</span><span class="p">)</span>

<span class="go">Beginning experiments</span>

<span class="go">Run Number: 1</span>
<span class="go">Test set acc.: 0.656</span>
<span class="go">Training set acc.: 0.667</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 2</span>
<span class="go">Test set acc.: 0.719</span>
<span class="go">Training set acc.: 0.719</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 3</span>
<span class="go">Test set acc.: 0.833</span>
<span class="go">Training set acc.: 0.844</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 4</span>
<span class="go">Test set acc.: 0.750</span>
<span class="go">Training set acc.: 0.771</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 5</span>
<span class="go">Test set acc.: 0.812</span>
<span class="go">Training set acc.: 0.844</span>
<span class="go">------------------------------</span>

<span class="go">Finished with training/testing experiments</span>

<span class="go">Test Set</span>
<span class="go">---------</span>
<span class="go">Average accuracy: 0.754</span>
<span class="go">Standard deviation: 0.064</span>

<span class="go">Training Set</span>
<span class="go">---------</span>
<span class="go">Average accuracy: 0.769</span>
<span class="go">Standard deviation: 0.070</span>

<span class="go">For more metrics, see the outputs.</span>
</pre></div>
</div>
</div>
<div class="section" id="hyperparameter-tuning">
<h2><span class="section-number">2.2.2.2.2. </span>Hyperparameter tuning<a class="headerlink" href="#hyperparameter-tuning" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>Our package also provides user with hyperparameter tuning.
When it is enabled, user is expected to provide the parameters and their range in a dictionary to tune parameters.
Algorithm implements <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">GridSearchCV</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML.PD_Classification</span> <span class="kn">import</span> <span class="n">getPercentScore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML</span> <span class="kn">import</span> <span class="n">feature_functions</span> <span class="k">as</span> <span class="n">fF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.ML.Base</span> <span class="kn">import</span> <span class="n">ParameterBucket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">teaspoon.MakeData.PointCloud</span> <span class="kn">import</span> <span class="n">testSetManifolds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># generate persistence diagrams</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF</span> <span class="o">=</span> <span class="n">testSetManifolds</span><span class="p">(</span><span class="n">numDgms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">numPts</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_col</span><span class="o">=</span><span class="s1">&#39;trainingLabel&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dgm_col</span><span class="o">=</span><span class="s1">&#39;Dgm1&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># convert categorical labels into integers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">DgmsDF</span><span class="p">[</span><span class="n">labels_col</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DgmsDF</span><span class="p">[</span><span class="n">labels_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set classification parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">ParameterBucket</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">feature_function</span> <span class="o">=</span> <span class="n">fF</span><span class="o">.</span><span class="n">F_Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">k_fold_cv</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">clf_model</span> <span class="o">=</span> <span class="n">SVC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">param_tuning</span> <span class="o">=</span> <span class="kc">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parameters to tune and their ranges</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">parToTune</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># the list that contains the parameters to tune for each classifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="o">.</span><span class="n">parToTune</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="n">lambda_range</span><span class="p">,</span><span class="s1">&#39;gamma&#39;</span><span class="p">:</span><span class="n">gamma_range</span><span class="p">})</span> <span class="c1"># SVM paramters</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># perform classification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_report_train</span><span class="p">,</span><span class="n">c_report_test</span><span class="o">=</span><span class="n">getPercentScore</span><span class="p">(</span><span class="n">DgmsDF_train</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">labels_col</span><span class="o">=</span><span class="s1">&#39;trainingLabel&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">dgm_col</span><span class="o">=</span><span class="s1">&#39;Dgm1&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">precomputed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">saving</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">saving_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                            <span class="n">DgmsDF_test</span> <span class="o">=</span> <span class="n">DgmsDF_test</span><span class="p">)</span>

<span class="go">Beginning experiments</span>

<span class="go">Run Number: 1</span>
<span class="go">Test set acc.: 0.958</span>
<span class="go">Training set acc.: 1.000</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 2</span>
<span class="go">Test set acc.: 0.958</span>
<span class="go">Training set acc.: 0.990</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 3</span>
<span class="go">Test set acc.: 1.000</span>
<span class="go">Training set acc.: 0.990</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 4</span>
<span class="go">Test set acc.: 0.958</span>
<span class="go">Training set acc.: 0.990</span>
<span class="go">------------------------------</span>
<span class="go">Run Number: 5</span>
<span class="go">Test set acc.: 1.000</span>
<span class="go">Training set acc.: 1.000</span>
<span class="go">------------------------------</span>

<span class="go">Finished with training/testing experiments</span>

<span class="go">Test Set</span>
<span class="go">---------</span>
<span class="go">Average accuracy: 0.975</span>
<span class="go">Standard deviation: 0.020</span>

<span class="go">Training Set</span>
<span class="go">---------</span>
<span class="go">Average accuracy: 0.994</span>
<span class="go">Standard deviation: 0.005</span>

<span class="go">For more metrics, see the outputs.</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CL_PL.html" class="btn btn-neutral float-left" title="2.2.2.1. Persistence Landscapes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CL_CC.html" class="btn btn-neutral float-right" title="2.2.2.3. Carlsson Coordinates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Munch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>