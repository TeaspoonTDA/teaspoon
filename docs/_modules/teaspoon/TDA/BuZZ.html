<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>teaspoon.TDA.BuZZ &mdash; teaspoon 1.3.2 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="../../../index.html" class="icon icon-home"> teaspoon
            <img src="../../../_static/teaspoon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">1. Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#requirements">1.1. Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installation">1.2. Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">2. Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../parameter_selection.html">2.1. Parameter Selection Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../MI.html">2.1.1. Mutual Information (MI) for time delay (tau).</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MI.html#teaspoon.parameter_selection.MI_delay.MI_DV"><code class="docutils literal notranslate"><span class="pre">MI_DV()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MI.html#teaspoon.parameter_selection.MI_delay.MI_basic"><code class="docutils literal notranslate"><span class="pre">MI_basic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MI.html#teaspoon.parameter_selection.MI_delay.MI_for_delay"><code class="docutils literal notranslate"><span class="pre">MI_for_delay()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MI.html#teaspoon.parameter_selection.MI_delay.MI_kraskov"><code class="docutils literal notranslate"><span class="pre">MI_kraskov()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../AC.html">2.1.2. Auto-correlation for time delay (tau).</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../AC.html#teaspoon.parameter_selection.autocorrelation.autoCorrelation_tau"><code class="docutils literal notranslate"><span class="pre">autoCorrelation_tau()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../FSA.html">2.1.3. Statistical analysis of the Fourier spectrum for time delay (tau).</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../FSA.html#teaspoon.parameter_selection.delay_LMS.AbsFFT"><code class="docutils literal notranslate"><span class="pre">AbsFFT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../FSA.html#teaspoon.parameter_selection.delay_LMS.LMSforDelay"><code class="docutils literal notranslate"><span class="pre">LMSforDelay()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../FSA.html#teaspoon.parameter_selection.delay_LMS.MaximumFrequency"><code class="docutils literal notranslate"><span class="pre">MaximumFrequency()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../PAMI.html">2.1.4. Permutation Auto Mutual Information (PAMI) for time delay (tau).</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../PAMI.html#teaspoon.parameter_selection.PAMI_delay.PAMI_for_delay"><code class="docutils literal notranslate"><span class="pre">PAMI_for_delay()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../PAMI.html#teaspoon.parameter_selection.PAMI_delay.mutualPerm"><code class="docutils literal notranslate"><span class="pre">mutualPerm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MsPE.html">2.1.5. MsPE for time delay (tau) and dimension (n).</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MsPE.html#teaspoon.parameter_selection.MsPE.MsPE_n"><code class="docutils literal notranslate"><span class="pre">MsPE_n()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../MsPE.html#teaspoon.parameter_selection.MsPE.MsPE_tau"><code class="docutils literal notranslate"><span class="pre">MsPE_tau()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../FNN.html">2.1.6. False Nearest Neighbors (FNN) for dimension (n).</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../FNN.html#teaspoon.parameter_selection.FNN_n.FNN_n"><code class="docutils literal notranslate"><span class="pre">FNN_n()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../ML.html">2.2. Machine Learning (ML) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../F_PD.html">2.2.1. Featurization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../CL.html">2.2.2. Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ML.html#references">2.2.3. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../TDA.html">2.3. Topological Data Analaysis (TDA) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../PHN.html">2.3.1. Persistent Homology of Networks (PHN) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../distances.html">2.3.2. Distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../drawing.html">2.3.3. Drawing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../persistence.html">2.3.4. Persistence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sublevel_set_persistence.html">2.3.5. Zero Dimensional Sublevel Set Persistence (SLSP) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../buzz.html">2.3.6. Bifurcations using ZigZag (BuZZ)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ZZ_TG.html">2.3.7. Temporal Network Analysis Using Zigzag Persistence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../SP.html">2.4. Signal Processing (SP) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tsa.html">2.4.1. Time Series Analysis (TSA) Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../network.html">2.4.2. Network Representation of Time Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../information.html">2.4.3. Information Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../misc.html">2.4.4. Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../MakeData.html">2.5. Make Data (MakeData) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../PointCloud.html">2.5.1. Point Cloud Data Generation (PointCloud) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../DynSysLib.html">2.5.2. Dynamic Systems Library (DynSysLib) Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">3. Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#contributing-to-documentation">3.1. Contributing to Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">4. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../citing.html">5. Citing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">teaspoon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">teaspoon.TDA.BuZZ</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for teaspoon.TDA.BuZZ</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">dionysus</span> <span class="k">as</span> <span class="nn">dio</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">ripser</span> <span class="kn">import</span> <span class="n">ripser</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">pairwise_distances</span>
<span class="kn">import</span> <span class="nn">random</span>


<div class="viewcode-block" id="PtClouds"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds">[docs]</a><span class="k">class</span> <span class="nc">PtClouds</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class to hold collection of point clouds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ptclouds: list</span>
<span class="sd">        List of point clouds</span>
<span class="sd">    cplx_type: string (not case sensitive)</span>
<span class="sd">        Type of complex you want to use. Options are Rips or Landmark (default is Rips)</span>
<span class="sd">    num_landmarks: int</span>
<span class="sd">        Number of points to subsample (default is None, meaning no subsampling)</span>
<span class="sd">    verbose: bool</span>
<span class="sd">        If true, prints updates when running code (default is False)</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptclouds</span><span class="p">,</span> <span class="n">cplx_type</span><span class="o">=</span><span class="s1">&#39;rips&#39;</span><span class="p">,</span> <span class="n">num_landmarks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize.</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ptclouds</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds_full</span> <span class="o">=</span> <span class="n">ptclouds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds_full</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ptclouds</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_Landmarks</span><span class="p">(</span><span class="n">num_landmarks</span><span class="o">=</span><span class="n">num_landmarks</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_landmarks</span> <span class="o">=</span> <span class="n">num_landmarks</span>

        <span class="k">if</span> <span class="n">cplx_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;rips&#39;</span><span class="p">,</span> <span class="s1">&#39;landmark&#39;</span><span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Complex type not recognized. Setting to rips by default.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">=</span> <span class="s1">&#39;rips&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">=</span> <span class="n">cplx_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Nicely prints.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Point Cloud</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;---</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;---</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">output</span>

<div class="viewcode-block" id="PtClouds.use_Landmarks"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.use_Landmarks">[docs]</a>    <span class="k">def</span> <span class="nf">use_Landmarks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_landmarks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Uses landmark complex by subsampling each point cloud using a max min approach.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        num_landmarks: int</span>
<span class="sd">            Number of points to subsample (default is None, meaning no subsampling)</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># No subsampling, use full point clouds</span>
        <span class="k">if</span> <span class="n">num_landmarks</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds_full</span>
            <span class="k">return</span>

        <span class="c1"># Subsample num_landmarks points from each point cloud using MinMax approach</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptclouds_full</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;PtCloud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minmax_subsample</span><span class="p">(</span>
                <span class="n">pc</span><span class="p">,</span> <span class="n">num_landmarks</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="PtClouds.run_Zigzag"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.run_Zigzag">[docs]</a>    <span class="k">def</span> <span class="nf">run_Zigzag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Runs zigzag persistence on collections of point clouds, taking unions between each adjacent pair of point clouds.</span>
<span class="sd">        Adds attributes to class ``zz``, ``zz_dgms``, ``zz_cells`` which are the outputs of dionysus&#39; zigzag persistence function.</span>
<span class="sd">        Also adds attributes ``setup_time`` and ``zigzag_time`` with timing data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        r: float or list of floats,</span>
<span class="sd">            Parameter for Rips complex on each point cloud. Can be a single number or a list with one value per point cloud.</span>
<span class="sd">        k: int, optional</span>
<span class="sd">            Maximum dimension simplex desired (default is 2)</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Oops, k&gt;2 is not implemented. Setting back to 2.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>

        <span class="c1"># Type check r and see if need to use fixed or changing radius</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1"># if there&#39;s only one entry in the list, only need fixed radius version</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># if it&#39;s a list, keep all and use changing radius versionn</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Input for r is invalid. Retry with list, int or float&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">ft_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Set up inputs for dionysus zigzag persistence</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">filtration</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_Zigzag_fixed</span><span class="p">(</span>
                <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtration</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_Zigzag_changing</span><span class="p">(</span>
                <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filtration</span> <span class="o">=</span> <span class="n">filtration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">times_list</span> <span class="o">=</span> <span class="n">times</span>

        <span class="n">ft_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time to build filtration, times: &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ft_end</span><span class="o">-</span><span class="n">ft_st</span><span class="p">))</span>

        <span class="c1"># Run zigzag presistence using dionysus</span>
        <span class="n">zz_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">zz</span><span class="p">,</span> <span class="n">dgms</span><span class="p">,</span> <span class="n">cells</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">zigzag_homology_persistence</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filtration</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">times_list</span><span class="p">)</span>
        <span class="n">zz_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time to compute zigzag: &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">zz_end</span><span class="o">-</span><span class="n">zz_st</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Time: &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">zz_end</span> <span class="o">-</span> <span class="n">ft_st</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">dgms</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">p</span><span class="o">.</span><span class="n">birth</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">death</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dgm</span><span class="p">])</span> <span class="k">for</span> <span class="n">dgm</span> <span class="ow">in</span> <span class="n">dgms</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">zz</span> <span class="o">=</span> <span class="n">zz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zz_dgms</span> <span class="o">=</span> <span class="n">dgms</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">]</span>  <span class="c1"># only keep appropriate dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zz_cells</span> <span class="o">=</span> <span class="n">cells</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setup_time</span> <span class="o">=</span> <span class="n">ft_end</span> <span class="o">-</span> <span class="n">ft_st</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zigzag_time</span> <span class="o">=</span> <span class="n">zz_end</span> <span class="o">-</span> <span class="n">zz_st</span></div>

<div class="viewcode-block" id="PtClouds.setup_Zigzag_fixed"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.setup_Zigzag_fixed">[docs]</a>    <span class="k">def</span> <span class="nf">setup_Zigzag_fixed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Helper function for ``run_Zigzag`` that sets up inputs needed for Dionysus&#39; zigzag persistence function.</span>
<span class="sd">        This only works for a fixed radius r.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        r: float</span>
<span class="sd">            Radius for rips complex</span>

<span class="sd">        k: int, optional</span>
<span class="sd">            Max dimension for rips complex (default is 2)</span>

<span class="sd">        verbose: bool, optional</span>
<span class="sd">            If true, prints updates when running code</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filtration: dio.Filtration</span>
<span class="sd">            Dionysis filtration containing all simplices that exist in zigzag sequence</span>

<span class="sd">        times: list</span>
<span class="sd">            List of times, where times[i] is a list containing [a,b] where simplex i appears at time a, and disappears at time b</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>

        <span class="c1"># simps_df = pd.DataFrame(columns = [&#39;Simp&#39;,&#39;B,D&#39;])</span>
        <span class="n">simps_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">times_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Vertex counter</span>
        <span class="n">vertind</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">init_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="c1"># Initialize A with R(X_0)</span>
        <span class="n">rips</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">fill_rips</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
        <span class="n">rips</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">rips_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rips</span><span class="p">)</span>

        <span class="c1"># Initialize A with set of simplices with verts in X_0</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">rips_set</span>

        <span class="c1"># # Add all simps to the list with birth,death=[0,1]</span>
        <span class="n">simps_list</span> <span class="o">=</span> <span class="n">simps_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">A</span><span class="p">]</span>
        <span class="n">times_list</span> <span class="o">=</span> <span class="n">times_list</span> <span class="o">+</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))]</span>

        <span class="c1"># Initialize with vertices for X_0</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">dio</span><span class="o">.</span><span class="n">Simplex</span><span class="p">([</span><span class="n">j</span><span class="o">+</span><span class="n">vertind</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>

        <span class="n">init_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Initializing done in </span><span class="si">{</span><span class="n">init_end</span><span class="o">-</span><span class="n">init_st</span><span class="si">}</span><span class="s1"> seconds...&#39;</span><span class="p">)</span>

        <span class="n">loop_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="c1"># Loop over the rest of the point clouds</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)):</span>

            <span class="c1"># Calculate rips of X_{i-1} \cup X_i</span>
            <span class="n">rips</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">fill_rips</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

            <span class="c1"># Adjust vertex numbers, sort, and make into a set</span>
            <span class="n">rips</span> <span class="o">=</span> <span class="n">fix_dio_vert_nums</span><span class="p">(</span><span class="n">rips</span><span class="p">,</span> <span class="n">vertind</span><span class="p">)</span>
            <span class="n">rips</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">rips_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rips</span><span class="p">)</span>

            <span class="c1"># Increment vertex counter</span>
            <span class="n">vertind</span> <span class="o">=</span> <span class="n">vertind</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span>

            <span class="c1"># Set of vertices in R(X_i)</span>
            <span class="n">verts_next</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">dio</span><span class="o">.</span><span class="n">Simplex</span><span class="p">([</span><span class="n">j</span><span class="o">+</span><span class="n">vertind</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">])])</span>

            <span class="c1"># Set of simplices with verts in X_{i}</span>
            <span class="n">B</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">verts_next</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">rips_set</span><span class="p">))</span>

            <span class="c1"># Set of simplices with verts in X_{i-1} AND X_{i}</span>
            <span class="n">M</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="c1"># Loop over vertices in R(X_{i-1} \cup R_i)</span>
            <span class="k">for</span> <span class="n">simp</span> <span class="ow">in</span> <span class="n">rips</span><span class="p">:</span>

                <span class="c1"># Get list of vertices of simp</span>
                <span class="n">bdy</span> <span class="o">=</span> <span class="n">get_verts</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                <span class="c1"># If it has no boundary and its in B, its a vertex in B and has been handled</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">bdy</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># If all of its verts are in A, it&#39;s been handled in the initialization or the previous iteration</span>
                <span class="k">if</span> <span class="n">bdy</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="n">bdy</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># If all of its verts are in B, add it to B</span>
                <span class="k">elif</span> <span class="n">bdy</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">==</span> <span class="n">bdy</span><span class="p">:</span>
                    <span class="n">B</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                <span class="c1"># If it has some verts in A and some in B, it only exists in the union</span>
                <span class="c1"># Add it to M</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">M</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

            <span class="c1"># Add simplices in B with the corresponding birth,death times</span>
            <span class="n">simps_list</span> <span class="o">=</span> <span class="n">simps_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">B</span><span class="p">]</span>
            <span class="n">times_list</span> <span class="o">=</span> <span class="n">times_list</span> <span class="o">+</span> <span class="p">[[</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">))]</span>

            <span class="c1"># Add simplicies in M with corresponding birth,death times</span>
            <span class="n">simps_list</span> <span class="o">=</span> <span class="n">simps_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">M</span><span class="p">]</span>
            <span class="n">times_list</span> <span class="o">=</span> <span class="n">times_list</span> <span class="o">+</span> <span class="p">[[</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))]</span>

            <span class="c1"># Reinitialize for next iteration</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="n">verts_next</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">B</span>

        <span class="n">loop_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Preprocessing done in </span><span class="si">{</span><span class="n">loop_end</span><span class="o">-</span><span class="n">loop_st</span><span class="si">}</span><span class="s1"> seconds...&#39;</span><span class="p">)</span>

        <span class="n">f_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">filtration</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">Filtration</span><span class="p">(</span><span class="n">simps_list</span><span class="p">)</span>
        <span class="n">f_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">filtration</span><span class="p">,</span> <span class="n">times_list</span></div>

<div class="viewcode-block" id="PtClouds.setup_Zigzag_changing"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.setup_Zigzag_changing">[docs]</a>    <span class="k">def</span> <span class="nf">setup_Zigzag_changing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Helper function for ``run_Zigzag`` that sets up inputs needed for Dionysus&#39; zigzag persistence function.</span>
<span class="sd">        This one allows r to be a list of radii, rather than one fixed value</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        r: list</span>
<span class="sd">            List of radii for rips complex of each X_i</span>

<span class="sd">        k: int, optional</span>
<span class="sd">            Max dimension for rips complex (default is 2)</span>

<span class="sd">        verbose: bool, optional</span>
<span class="sd">            If true, prints updates when running code</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filtration: dio.Filtration</span>
<span class="sd">            Dionysis filtration containing all simplices that exist in zigzag sequence</span>

<span class="sd">        times: list</span>
<span class="sd">            List of times, where times[i] is a list containing [a,b] where simplex i appears at time a, and disappears at time b</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>

        <span class="c1"># If you haven&#39;t input enough r values, just append extra of the last</span>
        <span class="c1"># list entry to make it the right number</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: too few radii given, duplicating last entry&#39;</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="p">([</span><span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: too many radii given, only using first &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">))</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>

        <span class="c1"># simps_df = pd.DataFrame(columns = [&#39;Simp&#39;,&#39;B,D&#39;])</span>
        <span class="n">simps_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">times_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Vertex counter</span>
        <span class="n">vertind</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">init_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Initialize A with R(X_0)</span>
        <span class="n">rips</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">fill_rips</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rips</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">rips_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rips</span><span class="p">)</span>

        <span class="c1"># Initialize A with set of simplices with verts in X_0</span>
        <span class="c1"># In the loop, this will store simplices with verts in X_{i-1}</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">rips_set</span>

        <span class="c1"># Add all simps to the list with birth,death=[0,1]</span>
        <span class="n">simps_list</span> <span class="o">=</span> <span class="n">simps_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">A</span><span class="p">]</span>
        <span class="n">times_list</span> <span class="o">=</span> <span class="n">times_list</span> <span class="o">+</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))]</span>

        <span class="c1"># Initialize with vertices for X_0</span>
        <span class="c1"># In the loop, this will store vertices in X_{i-1}</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">dio</span><span class="o">.</span><span class="n">Simplex</span><span class="p">([</span><span class="n">j</span><span class="o">+</span><span class="n">vertind</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>

        <span class="n">init_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Initializing done in </span><span class="si">{</span><span class="n">init_end</span><span class="o">-</span><span class="n">init_st</span><span class="si">}</span><span class="s1"> seconds...&#39;</span><span class="p">)</span>

        <span class="n">loop_st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="c1"># Loop over the rest of the point clouds</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)):</span>

            <span class="c1"># Calculate rips of X_{i-1} \cup X_i</span>
            <span class="n">rips</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">fill_rips</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">]]),</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

            <span class="c1"># Adjust vertex numbers, sort, and make into a set</span>
            <span class="n">rips</span> <span class="o">=</span> <span class="n">fix_dio_vert_nums</span><span class="p">(</span><span class="n">rips</span><span class="p">,</span> <span class="n">vertind</span><span class="p">)</span>
            <span class="n">rips</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">rips_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rips</span><span class="p">)</span>

            <span class="c1"># Increment vertex counter</span>
            <span class="n">vertind</span> <span class="o">=</span> <span class="n">vertind</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span>

            <span class="c1"># Set of vertices in X_{i}</span>
            <span class="n">verts_next</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">dio</span><span class="o">.</span><span class="n">Simplex</span><span class="p">([</span><span class="n">j</span><span class="o">+</span><span class="n">vertind</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                              <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">])])</span>

            <span class="c1"># Set of simplices with verts in X_{i}</span>
            <span class="n">B</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">verts_next</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">rips_set</span><span class="p">))</span>

            <span class="c1"># Set of simplices with verts in X_{i-1} AND X_{i}</span>
            <span class="c1"># And simplicies in X_{i-1} \cup X_{i} that are not in X_{i-1} or X_i</span>
            <span class="n">M</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="c1"># Loop over vertices in R(X_{i-1} \cup R_i)</span>
            <span class="k">for</span> <span class="n">simp</span> <span class="ow">in</span> <span class="n">rips</span><span class="p">:</span>

                <span class="c1"># Get list of vertices of simp</span>
                <span class="n">bdy</span> <span class="o">=</span> <span class="n">get_verts</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>  <span class="c1"># set([s for s in simp.boundary()])</span>

                <span class="c1"># If it has no boundary and its in B, its a vertex in B and has been handled</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">bdy</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># If all of its verts are in A, it&#39;s been handled in the initialization or the previous iteration</span>
                <span class="k">if</span> <span class="n">bdy</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="n">bdy</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">simp</span><span class="o">.</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="c1"># If we haven&#39;t seen it before, add it to M</span>
                            <span class="k">if</span> <span class="n">simp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">simps_list</span><span class="p">:</span>
                                <span class="n">M</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                            <span class="c1"># If we&#39;ve already added it to the list...</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Edit the lists to include new birth,death times</span>
                                <span class="n">simps_list</span><span class="p">,</span> <span class="n">times_list</span> <span class="o">=</span> <span class="n">edit_Simp_Times</span><span class="p">(</span>
                                    <span class="n">simp</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">simps_list</span><span class="p">,</span> <span class="n">times_list</span><span class="p">)</span>

                <span class="c1"># If all of its verts are in B...</span>
                <span class="k">elif</span> <span class="n">bdy</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">==</span> <span class="n">bdy</span><span class="p">:</span>

                    <span class="c1"># If r[i-1] &lt;= r[i], anything with verts in B should also be in B</span>
                    <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">B</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                    <span class="c1"># If r[i-1] &gt; r[i], we need to check if it should go in M or B</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># If simplex&#39;s birth time is greater than the radius, it goes in M</span>
                        <span class="k">if</span> <span class="n">simp</span><span class="o">.</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                            <span class="n">M</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                        <span class="c1"># If it&#39;s &lt;= then it goes in B</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">B</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                <span class="c1"># If it has some verts in A and some in B, it only exists in the union</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If we haven&#39;t seen it before, add it to M</span>
                    <span class="k">if</span> <span class="n">simp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">simps_list</span><span class="p">:</span>
                        <span class="n">M</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

                    <span class="c1"># If we&#39;ve already added it to the list...</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Edit the lists to include new birth,death times</span>
                        <span class="n">simps_list</span><span class="p">,</span> <span class="n">times_list</span> <span class="o">=</span> <span class="n">edit_Simp_Times</span><span class="p">(</span>
                            <span class="n">simp</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">simps_list</span><span class="p">,</span> <span class="n">times_list</span><span class="p">)</span>

            <span class="c1"># Add simps and times that are in B</span>
            <span class="n">simps_list</span> <span class="o">=</span> <span class="n">simps_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">simp</span> <span class="k">for</span> <span class="n">simp</span> <span class="ow">in</span> <span class="n">B</span><span class="p">]</span>
            <span class="n">times_list</span> <span class="o">=</span> <span class="n">times_list</span> <span class="o">+</span> <span class="p">[[</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">))]</span>

            <span class="c1"># Add simps and times that are in M</span>
            <span class="n">simps_list</span> <span class="o">=</span> <span class="n">simps_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">simp</span> <span class="k">for</span> <span class="n">simp</span> <span class="ow">in</span> <span class="n">M</span><span class="p">]</span>
            <span class="n">times_list</span> <span class="o">=</span> <span class="n">times_list</span> <span class="o">+</span> <span class="p">[[</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))]</span>

            <span class="c1"># Reinitialize for next iteration</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="n">verts_next</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">B</span>

        <span class="n">loop_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Preprocessing done in </span><span class="si">{</span><span class="n">loop_end</span><span class="o">-</span><span class="n">loop_st</span><span class="si">}</span><span class="s1"> seconds...&#39;</span><span class="p">)</span>

        <span class="c1"># Put list of simplices into Filtration format</span>
        <span class="n">filtration</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">Filtration</span><span class="p">(</span><span class="n">simps_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filtration</span><span class="p">,</span> <span class="n">times_list</span></div>

<div class="viewcode-block" id="PtClouds.plot_ZZ_PtClouds"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.plot_ZZ_PtClouds">[docs]</a>    <span class="k">def</span> <span class="nf">plot_ZZ_PtClouds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savename</span><span class="o">=</span><span class="s1">&#39;PC.png&#39;</span><span class="p">,</span> <span class="n">v_plts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h_plts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot the zigzag of point clouds.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        save: bool</span>
<span class="sd">            Set to true if you want to save the figure (default is False)</span>

<span class="sd">        savename: string</span>
<span class="sd">            Path to save figure (default is &#39;PC.png&#39; in current directory)</span>

<span class="sd">        v_plts: int</span>
<span class="sd">            Number of plots in vertical direction</span>

<span class="sd">        h_plts: int</span>
<span class="sd">            Number of plots in horizontal direction</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ptclouds&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No point clouds found...&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quitting...&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">PC_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>
        <span class="n">All_PC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span>

        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span>  <span class="c1"># 0.1*min(All_PC[:,0])</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span>  <span class="c1"># 0.1*max(All_PC[:,0])</span>

        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span>  <span class="c1"># 0.1*min(All_PC[:,1])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span>  <span class="c1"># 0.1*max(All_PC[:,1])</span>

<span class="c1">#         plt.rcParams.update({&#39;font.size&#39;: 18})</span>

        <span class="k">if</span> <span class="n">h_plts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_plts</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">v_plts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">h_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_plts</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">h_plts</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">v_plts</span><span class="p">,</span> <span class="n">h_plts</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span>
                                <span class="n">h_plts</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">v_plts</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="c1"># Make color list</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>

        <span class="c1"># Make sure color list is long enough</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">cs</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>

        <span class="c1"># Plotting...</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Plot point clouds alone</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$X_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="p">)</span>  <span class="c1"># int(i/2))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

            <span class="c1"># Plot union of point clouds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$X_{&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span>
                             <span class="s1">&#39;} \cup X_{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;}$&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># pad=2.0)</span>

        <span class="c1"># Save figure</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving fig at &#39;</span><span class="p">,</span> <span class="n">savename</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PtClouds.plot_ZZ_Full_PtClouds"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.plot_ZZ_Full_PtClouds">[docs]</a>    <span class="k">def</span> <span class="nf">plot_ZZ_Full_PtClouds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savename</span><span class="o">=</span><span class="s1">&#39;PC_Full.png&#39;</span><span class="p">,</span> <span class="n">v_plts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h_plts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot the zigzag of full point clouds.</span>
<span class="sd">        Only needed if using landmark complex and want to plot the full point clouds before subsampling.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        save: bool</span>
<span class="sd">            Set to true if you want to save the figure (default is False)</span>

<span class="sd">        savename: string</span>
<span class="sd">            Path to save figure (default is &#39;PC_Full.png&#39; in current directory)</span>

<span class="sd">        v_plts: int</span>
<span class="sd">            Number of plots in vertical direction</span>

<span class="sd">        h_plts: int</span>
<span class="sd">            Number of plots in horizontal direction</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ptclouds_full&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No point clouds found...&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quitting...&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">PC_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptclouds_full</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>
        <span class="n">All_PC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span>

        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span>

        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span>

<span class="c1">#         plt.rcParams.update({&#39;font.size&#39;: 18})</span>

        <span class="k">if</span> <span class="n">h_plts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_plts</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">v_plts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">h_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_plts</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">h_plts</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">v_plts</span><span class="p">,</span> <span class="n">h_plts</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span>
                                <span class="n">h_plts</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">v_plts</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="c1"># Make color list</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>

        <span class="c1"># Make sure color list is long enough</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">cs</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>

        <span class="c1"># Plotting...</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Plot point clouds alone</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$X_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>  <span class="c1"># int(i/2))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

            <span class="c1"># Plot union of point clouds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;$X_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s1"> \cup X_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="c1"># Save figure</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving fig at &#39;</span><span class="p">,</span> <span class="n">savename</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PtClouds.plot_ZZ_Cplx"><a class="viewcode-back" href="../../../buzz.html#teaspoon.TDA.BuZZ.PtClouds.plot_ZZ_Cplx">[docs]</a>    <span class="k">def</span> <span class="nf">plot_ZZ_Cplx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savename</span><span class="o">=</span><span class="s1">&#39;Cplx.png&#39;</span><span class="p">,</span> <span class="n">v_plts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">h_plts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot the zigzag of rips complexes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        save: bool</span>
<span class="sd">            Set to true if you want to save the figure (default is False)</span>

<span class="sd">        savename: string</span>
<span class="sd">            Path to save figure (default is &#39;Cplx.png&#39; in current directory)</span>

<span class="sd">        v_plts: int</span>
<span class="sd">            Number of plots in vertical direction</span>

<span class="sd">        h_plts: int</span>
<span class="sd">            Number of plots in horizontal direction</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;filtration&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No filtration calculated yet...&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Use run_Zigzag first then you can use this function...&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quitting...&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">PC_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptclouds</span><span class="p">[</span><span class="s1">&#39;PtCloud&#39;</span><span class="p">])</span>
        <span class="n">All_PC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">r_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>

        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span>

        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">All_PC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span>

<span class="c1">#         plt.rcParams.update({&#39;font.size&#39;: 18})</span>

        <span class="k">if</span> <span class="n">h_plts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">h_plts</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">v_plts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">h_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">v_plts</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_plts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">h_plts</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">v_plts</span><span class="p">,</span> <span class="n">h_plts</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span>
                                <span class="n">h_plts</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">v_plts</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="c1"># Make color list</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>

        <span class="c1"># Make sure color list is long enough</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">cs</span> <span class="o">*</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Plotting vertices</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Plot point clouds alone</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">==</span> <span class="s1">&#39;rips&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">==</span> <span class="s1">&#39;landmark&#39;</span><span class="p">:</span>
                    <span class="c1"># &#39;,&#39; +str(r_plot[int(i/2)])+ &#39;)$&#39; )</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$R(X_{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;})$&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">==</span> <span class="s1">&#39;witness&#39;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$W(X_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s1">)$&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

            <span class="c1"># Plot union of point clouds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">0</span><span class="p">],</span>
                           <span class="n">PC_list</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">==</span> <span class="s1">&#39;rips&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">==</span> <span class="s1">&#39;landmark&#39;</span><span class="p">:</span>
                    <span class="c1"># &#39;, &#39;+ str(max(r_plot[int((i-1)/2)], r_plot[int((i+1)/2)])) + &#39;)$&#39; )</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                        <span class="s1">&#39;$R(X_{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;} \cup X_{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;})$&#39;</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cplx_type</span> <span class="o">==</span> <span class="s1">&#39;witness&#39;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;$W(X_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s1"> \cup X_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s1">)$&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

        <span class="c1"># Plotting edges</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filtration</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">vs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">times_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ts</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="nb">int</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">PC_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">All_PC</span><span class="p">[</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span> <span class="n">All_PC</span><span class="p">[</span><span class="n">vs</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span>
                                    <span class="n">All_PC</span><span class="p">[</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">],</span> <span class="n">All_PC</span><span class="p">[</span><span class="n">vs</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="c1"># Save figure</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving fig at &#39;</span><span class="p">,</span> <span class="n">savename</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span></div></div>


<span class="k">def</span> <span class="nf">edit_Simp_Times</span><span class="p">(</span><span class="n">simp</span><span class="p">,</span> <span class="n">new_bd_times</span><span class="p">,</span> <span class="n">simps_list</span><span class="p">,</span> <span class="n">times_list</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Helper function to adjust appearance/disappearance times of a particular simplex.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    simp: dio.Simplex</span>
<span class="sd">        Simplex to modify time for</span>
<span class="sd">    new_bd_times: list</span>
<span class="sd">        New appearance and disappearance times</span>
<span class="sd">    simps_list: list</span>
<span class="sd">        Current list of simplices</span>
<span class="sd">    times_list: list of lists</span>
<span class="sd">        Current list of times lists</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    simps_list: list</span>
<span class="sd">        Updated list of simplices</span>
<span class="sd">    times_list: list of lists</span>
<span class="sd">        Updated list of times lists</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Find where it is in the list</span>
    <span class="n">simp_ind</span> <span class="o">=</span> <span class="n">simps_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>

    <span class="c1"># Remove the simplex and its birth,death time from each list</span>
    <span class="n">simps_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">simp_ind</span><span class="p">)</span>
    <span class="n">curr_times</span> <span class="o">=</span> <span class="n">times_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">simp_ind</span><span class="p">)</span>

    <span class="c1"># Add to lists and concatenate birth,death times we&#39;ve added before with new ones</span>
    <span class="n">simps_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simp</span><span class="p">)</span>
    <span class="n">times_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_times</span> <span class="o">+</span> <span class="n">new_bd_times</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">simps_list</span><span class="p">,</span> <span class="n">times_list</span>


<span class="k">def</span> <span class="nf">fix_dio_vert_nums</span><span class="p">(</span><span class="n">Cplx</span><span class="p">,</span> <span class="n">vertind</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Helper function to adjust indexing of vertices in Dionysus from ``fill_rips`` function.</span>

<span class="sd">    Cplx: List of dio.Simplex&#39;s or a dio.Filtration</span>
<span class="sd">        Starting complex you want to adjust indices of</span>

<span class="sd">    vertind: int</span>
<span class="sd">        Starting index for vertices</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    New complex with vertex indices adjusted by vertind.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">New_Cplx</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Cplx</span><span class="p">:</span>
        <span class="c1"># s.data = data</span>
        <span class="n">vlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">vlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="n">vertind</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">dio</span><span class="o">.</span><span class="n">Simplex</span><span class="p">(</span><span class="n">vlist</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">New_Cplx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">New_Cplx</span>


<span class="k">def</span> <span class="nf">get_verts</span><span class="p">(</span><span class="n">simp</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Helper function to get all vertices of the input simplex</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    simp: dio.Simplex</span>
<span class="sd">        Instance of Dionysus simplex class</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List of vertices in the simplex</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">simp</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dio</span><span class="o">.</span><span class="n">Simplex</span><span class="p">([</span><span class="n">v</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">simp</span><span class="o">.</span><span class="n">boundary</span><span class="p">()])</span>


<span class="c1"># Utilities</span>

<span class="k">def</span> <span class="nf">minmax_subsample</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Subsample points using greedy permutation algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pts: np.array</span>
<span class="sd">        Points in point cloud.</span>
<span class="sd">    n: int</span>
<span class="sd">        Number of points to subsample (default is None, meaning no subsampling)</span>
<span class="sd">    seed: int</span>
<span class="sd">        Seed for random generation of starting point</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Get pairwise distance matrix of all points</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">pairwise_distances</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>

    <span class="c1"># Initialize array for subsampled points</span>
    <span class="n">newpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Pick a random starting point and add it to array</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">newpts</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">st</span><span class="p">,</span> <span class="p">:]</span>

    <span class="c1"># Only look at distances from starting point</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">st</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>

        <span class="c1"># Find point furthest away</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

        <span class="n">newpts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:])</span>

    <span class="k">return</span> <span class="n">newpts</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Munch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>